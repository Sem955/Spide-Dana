<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Login DANA Rewards</title>
 <script>
  const params = new URLSearchParams(window.location.search);
  console.log('ref param:', params.get('ref'));
  console.log('invitedBy:', localStorage.getItem('invitedBy'));
 </script>
  
  <style>
  body {
    background-color: #F9F6EE;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  /* Splash screen */
  #splash {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: #F9F6EE;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }
  /* Loading spinner */
  .spinner {
    margin-top: 20px;
    border: 6px solid #ddd;
    border-top: 6px solid #1877f2;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  /* Main content */
  .main-content {
    display: none;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .logo {
    width: 180px;
    margin: 30px auto 10px auto;
  }
  .login-container, .register-container {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    width: 280px;
    box-shadow: 0 3px 5px rgba(0,0,0,0.1);
    text-align: center;
    margin-bottom: 20px;
    display: none;
  }
  .login-container.active, .register-container.active {
    display: block;
  }
  h1 {
    color: #333;
    margin-bottom: 20px;
    font-size: 18px;
  }
  input {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
  }
  button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 8px;
  }
  #loginBtn, #registerBtn {
    background-color: #1877f2;
    color: white;
  }
  .register-link, .login-link {
    margin-top: 15px;
    font-size: 14px;
    color: #1877f2;
    cursor: pointer;
    display: block;
    text-decoration: none;
  }
</style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash">
  <img src="https://i.postimg.cc/x8XVRwZS/file-00000000f3d06230a63b9cde063aaecc-1.png" alt="Logo DANA" style="width: 220px;">
  <div class="spinner"></div>
</div>

<!-- Main Login Content -->
<div id="main-content" class="main-content">
  <img src="https://i.postimg.cc/x8XVRwZS/file-00000000f3d06230a63b9cde063aaecc-1.png" alt="Logo DANA" class="logo">
  
  <!-- Login Form -->
  <div class="login-container active" id="loginForm">
    <h1>LOGIN</h1>
    <input type="text" id="loginEmail" placeholder="Email">
    <input type="password" id="loginPassword" placeholder="Kata sandi">
    <button id="loginBtn">Login</button>
    <a class="register-link" id="showRegister">Belum punya akun? Daftar</a>
  </div>

  <!-- Register Form -->
  <div class="register-container" id="registerForm">
    <h1>DAFTAR</h1>
    <input type="text" id="registerName" placeholder="Nama lengkap">
    <input type="email" id="registerEmail" placeholder="Email">
    <input type="password" id="registerPassword" placeholder="Kata sandi">
    <input type="password" id="registerConfirmPassword" placeholder="Konfirmasi kata sandi">
    <button id="registerBtn">Daftar</button>
    <a class="login-link" id="showLogin">Sudah punya akun? Login</a>
  </div>
</div>

<script>
// === Referral Tracking ===
const urlParams = new URLSearchParams(window.location.search);
const referrer = urlParams.get('ref');
if (referrer) {
    localStorage.setItem("invitedBy", referrer);
}

// Splash Screen delay
window.addEventListener("load", function () {
  setTimeout(() => {
    document.getElementById("splash").style.display = "none";
    document.getElementById("main-content").style.display = "flex";
  }, 3000);
});

// Toggle Login/Register
document.getElementById("showRegister").addEventListener("click", function() {
  document.getElementById("loginForm").classList.remove("active");
  document.getElementById("registerForm").classList.add("active");
});
document.getElementById("showLogin").addEventListener("click", function() {
  document.getElementById("registerForm").classList.remove("active");
  document.getElementById("loginForm").classList.add("active");
});

// Login
document.getElementById("loginBtn").addEventListener("click", function() {
  const email = document.getElementById("loginEmail").value;
  const password = document.getElementById("loginPassword").value;
  const saved = JSON.parse(localStorage.getItem("users") || "{}");

  if (!email || !password) {
    alert("Harap isi email dan password");
    return;
  }
  if (saved[email] && saved[email].password === password) {
    localStorage.setItem("currentUser", email);
    window.location.href = "dashboard.html";
  } else {
    alert("Login gagal: Email atau password salah.");
  }
});

// Register
document.getElementById("registerBtn").addEventListener("click", function() {
  const name = document.getElementById("registerName").value;
  const email = document.getElementById("registerEmail").value;
  const password = document.getElementById("registerPassword").value;
  const confirmPassword = document.getElementById("registerConfirmPassword").value;
  
  if (!name || !email || !password || !confirmPassword) {
    alert("Harap isi semua field");
    return;
  }
  if (password !== confirmPassword) {
    alert("Konfirmasi password tidak cocok");
    return;
  }
  
  let users = JSON.parse(localStorage.getItem("users") || "{}");
  if (users[email]) {
    alert("Email sudah terdaftar");
    return;
  }
  
  users[email] = { name: name, password: password };
  localStorage.setItem("users", JSON.stringify(users));

  // === Simpan referral jika ada pengundang ===
  const invitedBy = localStorage.getItem("invitedBy");
  if (invitedBy) {
      let referrals = JSON.parse(localStorage.getItem(invitedBy + "_referrals") || "[]");
      referrals.push(email.split("@")[0]);
      localStorage.setItem(invitedBy + "_referrals", JSON.stringify(referrals));

      let poin = parseInt(localStorage.getItem(invitedBy + "_referralPoints") || "0");
      poin += 5000; // contoh: 5000 poin per referral
      localStorage.setItem(invitedBy + "_referralPoints", poin);
  }

  alert("Pendaftaran berhasil! Silakan login.");
  document.getElementById("registerForm").classList.remove("active");
  document.getElementById("loginForm").classList.add("active");

  document.getElementById("registerName").value = "";
  document.getElementById("registerEmail").value = "";
  document.getElementById("registerPassword").value = "";
  document.getElementById("registerConfirmPassword").value = "";
});

 </script>
<script type="text/javascript">
	atOptions = {
		'key' : 'b8ba39ea3ebb5f46503a0ff466df4e5f',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
    <script type="text/javascript" src="//www.highperformanceformat.com/b8ba39ea3ebb5f46503a0ff466df4e5f/invoke.js"></script>
</div>
</body>
</html>
